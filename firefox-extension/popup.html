<!-- path: popup.html -->
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>smart-apply</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      body { font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial; margin: 16px; width: 380px; }
      body.settings-open { width: 760px; }
      body.settings-open .settings-panel { max-height: 520px; }

      .topbar { margin-bottom: 10px; }
      .tabs { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
      .tab-btn { padding: 6px 12px; border-radius: 8px; border: 1px solid #d0d7de; background: #f9fafb; cursor: pointer; }
      .tab-btn.active { background: #2563eb; color: #fff; border-color: #2563eb; }
      .tab-btn.disabled { opacity: 0.5; cursor: not-allowed; }
      #clearBtn { padding: 6px 12px; border-radius: 8px; border: 1px solid #111827; background: #111827; color: #fff; cursor: pointer; }

      .hidden { display: none; }
      .row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
      label { display: block; margin: 8px 0 4px; font-weight: 600; }
      input[type="text"], input[type="email"], input[type="password"], textarea, select {
        width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #d0d7de; border-radius: 6px;
      }
      textarea { min-height: 120px; resize: vertical; }
      button { padding: 8px 12px; border: none; border-radius: 12px; cursor: pointer; background: #2563eb; color: #fff; font-weight: 600; }
      .status { margin-top: 10px; color: #6b7280; font-size: 12px; min-height: 18px; }
      .error { border-color: #b42318 !important; }
      .error-text { color: #b42318; font-size: 12px; margin-top: 4px; }

      .spinner { width: 22px; height: 22px; border: 3px solid #d1d5db; border-top-color: #2563eb; border-radius: 50%; animation: spin 1s linear infinite; }
      @keyframes spin { to { transform: rotate(360deg); } }
      .inline { display: inline-flex; align-items: center; gap: 8px; }
      .label { font-weight: 700; }

      .settings-panel { max-height: 260px; overflow: auto; padding-right: 4px; border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; background: #fff; }

      .section { margin-top: 14px; }
      .section h3 { margin: 6px 0 8px; font-size: 14px; }
      .add-btn { background: #10b981; border: none; padding: 6px 10px; border-radius: 6px; color: #fff; font-weight: 600; cursor: pointer; }
      .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
      .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }

      .entry { border: 1px solid #e5e7eb; border-radius: 8px; padding: 10px; margin-bottom: 10px; background: #fafafa; position: relative; }
      .entry small { color: #6b7280; }
      .entry .entry-del { position: absolute; top: 8px; right: 8px; width: 20px; height: 20px; border-radius: 50%; border: 1px solid #e5e7eb; background: #f9fafb; color: #6b7280; cursor: pointer; font-size: 12px; line-height: 1; display: inline-flex; align-items: center; justify-content: center; }
      .entry .entry-del:hover { background: #ef4444; color: #fff; border-color: #ef4444; }
      .section-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; margin-bottom: 6px; }
      .section-header h3 { margin: 0; font-size: 14px; font-weight: 600; }
    </style>
  </head>
  <body>
    <div class="topbar">
      <div class="tabs">
        <button id="tabLogin" class="tab-btn active" type="button">Login</button>
        <button id="tabRegister" class="tab-btn" type="button">Register</button>
        <button id="tabSetting" class="tab-btn" type="button">Setting</button>
        <button id="tabApply" class="tab-btn disabled" type="button" title="Complete settings to enable">Apply</button>
        <button id="clearBtn" type="button" title="Clear saved state">Clear</button>
      </div>
    </div>

    <!-- AUTH: LOGIN -->
    <div id="tabLoginPane">
      <label for="loginEmail">Email</label>
      <input id="loginEmail" type="email" placeholder="you@example.com" />
      <label for="loginPass">Password</label>
      <input id="loginPass" type="password" placeholder="••••••••" />
      <div class="row" style="margin-top:12px;">
        <button id="loginBtn" type="button">Login</button>
      </div>
    </div>

    <!-- AUTH: REGISTER -->
    <div id="tabRegisterPane" class="hidden">
      <label for="regEmail">Email</label>
      <input id="regEmail" type="email" placeholder="you@example.com" />
      <label for="regPass">Password</label>
      <input id="regPass" type="password" placeholder="••••••••" />
      <label for="regPass2">Confirm Password</label>
      <input id="regPass2" type="password" placeholder="••••••••" />
      <div class="row" style="margin-top:12px;">
        <button id="registerBtn" type="button">Create Account</button>
      </div>
    </div>

    <!-- APPLY TAB -->
    <div id="tabApplyPane" class="hidden">
      <label for="job">Job</label>
      <input id="job" type="text" placeholder="Senior Developer" />
      <div id="jobErr" class="error-text hidden">Job is required</div>

      <label for="company">Company name</label>
      <input id="company" type="text" placeholder="Acme Inc." />
      <div id="companyErr" class="error-text hidden">Company name is required</div>

      <div class="row" style="margin-top:12px;">
        <button id="checkBtn" type="button">Check</button>
      </div>

      <div id="status" class="status"></div>

      <div id="generateStep" class="row hidden" style="margin-top:12px;">
        <div id="genDone" class="inline hidden">
          <span class="label">Prompt Generated</span>
          <button id="copyBtn" type="button">Copy Prompt</button>
        </div>
      </div>

      <div id="updatesSection" class="hidden" style="margin-top:12px;">
        <label for="updates">Modified CV</label>
        <textarea id="updates" placeholder="Paste or type your modified CV here..."></textarea>
        <div id="updatesErr" class="error-text hidden">Modified CV cannot be empty</div>
        <div class="row" style="margin-top:8px;">
          <button id="createCvBtn" type="button" disabled>Create CV</button>
        </div>
        <div id="cvResult" class="status"></div>
      </div>
    </div>

    <!-- SETTING TAB -->
    <div id="tabSettingPane" class="hidden">
      <div class="settings-panel">
        <div class="section">
          <div class="grid-2">
            <div><input id="s_name" type="text" placeholder="Full Name" /></div>
            <div><input id="s_role" type="text" placeholder="Role" /></div>
            <div><input id="s_email" type="text" placeholder="Email" /></div>
            <div><input id="s_phone" type="text" placeholder="Mobile" /></div>
            <div><input id="s_linkedin" type="text" placeholder="Linkedin Url" /></div>
            <div><input id="s_address" type="text" placeholder="Address" /></div>
          </div>
          <div style="margin-top:8px;">
            <textarea id="s_summary" placeholder="Professional Summary..."></textarea>
          </div>
        </div>

        <div class="section">
          <div class="section-header">
            <h3><button id="addEduBtn" type="button" class="add-btn">+</button> Education</h3>
          </div>
          <div id="eduList"></div>
        </div>

        <div class="section">
          <div class="section-header">
            <h3><button id="addExpBtn" type="button" class="add-btn">+</button> Experience</h3>
          </div>
          <div id="expList"></div>
        </div>

        <div class="section">
          <div class="section-header">
            <h3><button id="addLangBtn" type="button" class="add-btn">+</button> Languages</h3>
          </div>
          <div id="langList"></div>
        </div>

        <div class="section">
          <div class="section-header">
            <h3><button id="addSkillBtn" type="button" class="add-btn">+</button> Skills</h3>
          </div>
          <div id="skillList"></div>
        </div>
      </div>
    </div>

    <script type="module" src="src/main.js"></script>
  </body>
</html>
